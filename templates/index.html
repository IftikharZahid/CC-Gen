<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Card Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .header {
            background: white;
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .input-section {
            padding: 30px;
        }

        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .input-group {
                grid-template-columns: 1fr;
            }
        }

        .input-field {
            margin-bottom: 15px;
        }

        .input-field label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 14px;
        }

        .input-field input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-field input:focus {
            outline: none;
            border-color: #3498db;
        }

        .help-text {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        .generate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
        }

        .generate-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-section {
            padding: 0 30px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #f39c12, #e67e22);
            width: 0%;
            transition: width 0.3s;
        }

        .status {
            color: #27ae60;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .results-section {
            padding: 30px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-header h2 {
            color: #2c3e50;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }

        .copy-selected {
            background: #27ae60;
        }

        .copy-all {
            background: #3498db;
        }

        .clear {
            background: #e74c3c;
        }

        .cards-display {
            background: #2c3e50;
            border-radius: 8px;
            padding: 20px;
            color: white;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
        }

        .card-item {
            margin-bottom: 10px;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .card-item:hover {
            background: #34495e;
        }

        .card-number {
            color: #3498db;
            font-weight: bold;
        }

        .card-expiry {
            color: #27ae60;
        }

        .card-cvv {
            color: #e74c3c;
            font-weight: bold;
        }

        .card-type {
            color: #9b59b6;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 12px;
        }

        .error {
            color: #e74c3c;
            background: #fadbd8;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header">
                <h1>üí≥ Credit Card Generator</h1>
                <p>Generate valid test credit card numbers for development purposes</p>
            </div>

            <div class="input-section">
                <div class="error" id="errorMessage"></div>
                
                <div class="input-group">
                    <div class="input-field">
                        <label for="binInput">BIN (First 6 digits)</label>
                        <input type="text" id="binInput" maxlength="6" value="411111" placeholder="Enter 6-digit BIN">
                        <div class="help-text">First 6 digits of the card number</div>
                    </div>
                    
                    <div class="input-field">
                        <label for="amountInput">Number of Cards</label>
                        <input type="number" id="amountInput" value="10" min="1" max="50" placeholder="1-50">
                        <div class="help-text">How many cards to generate (1-50)</div>
                    </div>
                </div>
                
                <button class="generate-btn" id="generateBtn">
                    üöÄ Generate Credit Cards
                </button>
            </div>

            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="status" id="statusLabel">Ready to generate</div>
            </div>

            <div class="results-section">
                <div class="results-header">
                    <h2>Generated Cards</h2>
                    <div class="action-buttons">
                        <button class="action-btn copy-selected" onclick="copySelected()">üìã Copy Selected</button>
                        <button class="action-btn copy-all" onclick="copyAll()">üìú Copy All</button>
                        <button class="action-btn clear" onclick="clearResults()">üóëÔ∏è Clear</button>
                    </div>
                </div>
                
                <div class="cards-display" id="cardsDisplay">
                    <!-- Cards will be displayed here -->
                    <div style="text-align: center; color: #7f8c8d; padding: 20px;">
                        No cards generated yet. Click the generate button to start.
                    </div>
                </div>
            </div>

            <div class="footer">
                <div>‚ö†Ô∏è For testing and development purposes only</div>
                <div>Generated cards are not valid for real transactions</div>
            </div>
        </div>
    </div>

    <script>
        let generatedCards = [];
        let selectedCardIndex = null;

        document.getElementById('generateBtn').addEventListener('click', generateCards);

        async function generateCards() {
            const bin = document.getElementById('binInput').value.trim();
            const amount = parseInt(document.getElementById('amountInput').value);
            const generateBtn = document.getElementById('generateBtn');
            const statusLabel = document.getElementById('statusLabel');
            const progressFill = document.getElementById('progressFill');
            const errorMessage = document.getElementById('errorMessage');

            // Hide error message
            errorMessage.style.display = 'none';

            // Validate inputs
            if (!bin || bin.length !== 6 || !/^\d+$/.test(bin)) {
                showError('BIN must be exactly 6 digits');
                return;
            }

            if (isNaN(amount) || amount < 1 || amount > 50) {
                showError('Amount must be between 1 and 50');
                return;
            }

            // Update UI
            generateBtn.disabled = true;
            generateBtn.textContent = '‚è≥ Generating...';
            statusLabel.textContent = 'Starting generation...';
            statusLabel.style.color = '#f39c12';
            progressFill.style.width = '0%';

            try {
                const response = await fetch('/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        bin: bin,
                        amount: amount
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.error || 'Generation failed');
                }

                // Simulate progress for better UX
                simulateProgress(amount, () => {
                    displayCards(data.cards);
                    generateBtn.disabled = false;
                    generateBtn.textContent = 'üöÄ Generate Credit Cards';
                    statusLabel.textContent = `‚úÖ Successfully generated ${data.cards.length} credit cards!`;
                    statusLabel.style.color = '#27ae60';
                    progressFill.style.width = '100%';
                });

            } catch (error) {
                showError(error.message);
                generateBtn.disabled = false;
                generateBtn.textContent = 'üöÄ Generate Credit Cards';
                statusLabel.textContent = '‚ùå Generation failed';
                statusLabel.style.color = '#e74c3c';
                progressFill.style.width = '0%';
            }
        }

        function simulateProgress(total, callback) {
            let current = 0;
            const progressFill = document.getElementById('progressFill');
            const statusLabel = document.getElementById('statusLabel');

            const interval = setInterval(() => {
                current++;
                const progress = (current / total) * 100;
                progressFill.style.width = `${progress}%`;
                statusLabel.textContent = `Generating card ${current}/${total}... (${Math.round(progress)}%)`;

                if (current >= total) {
                    clearInterval(interval);
                    setTimeout(callback, 100);
                }
            }, 50);
        }

        function displayCards(cards) {
            generatedCards = cards;
            selectedCardIndex = null;
            const cardsDisplay = document.getElementById('cardsDisplay');
            
            if (cards.length === 0) {
                cardsDisplay.innerHTML = '<div style="text-align: center; color: #7f8c8d; padding: 20px;">No cards generated.</div>';
                return;
            }

            let html = '<div style="margin-bottom: 15px; color: #f39c12; font-weight: bold;">Generated Credit Cards:</div>';
            
            cards.forEach((card, index) => {
                html += `
                    <div class="card-item" onclick="selectCard(${index})" id="card-${index}">
                        <span style="color: #f39c12;">#${card.index.toString().padStart(2, '0')}</span> ‚Ä¢ 
                        <span class="card-number">${card.formatted_number}</span> ‚Ä¢ 
                        <span class="card-expiry">${card.expiry}</span> ‚Ä¢ 
                        <span class="card-cvv">${card.cvv}</span> ‚Ä¢ 
                        <span class="card-type">${card.type}</span>
                    </div>
                `;
            });

            html += `<div style="margin-top: 15px; color: #7f8c8d; font-size: 12px;">Total: ${cards.length} cards generated ‚Ä¢ Click to select</div>`;
            
            cardsDisplay.innerHTML = html;
        }

        function selectCard(index) {
            selectedCardIndex = index;
            
            // Remove previous selection
            document.querySelectorAll('.card-item').forEach(item => {
                item.style.background = 'transparent';
            });
            
            // Highlight selected card
            const selectedCard = document.getElementById(`card-${index}`);
            if (selectedCard) {
                selectedCard.style.background = '#34495e';
            }
        }

        function copySelected() {
            if (selectedCardIndex === null || !generatedCards[selectedCardIndex]) {
                alert('Please select a card first by clicking on it.');
                return;
            }

            const card = generatedCards[selectedCardIndex];
            const cardText = `${card.number}|${card.expiry}|${card.cvv}`;
            
            navigator.clipboard.writeText(cardText).then(() => {
                updateStatus('‚úÖ Selected card copied to clipboard!', '#27ae60');
            }).catch(() => {
                // Fallback for older browsers
                copyToClipboardFallback(cardText);
                updateStatus('‚úÖ Selected card copied to clipboard!', '#27ae60');
            });
        }

        function copyAll() {
            if (generatedCards.length === 0) {
                alert('No cards to copy.');
                return;
            }

            const allCards = generatedCards.map(card => 
                `${card.number}|${card.expiry}|${card.cvv}`
            ).join('\n');
            
            navigator.clipboard.writeText(allCards).then(() => {
                updateStatus(`‚úÖ All ${generatedCards.length} cards copied to clipboard!`, '#27ae60');
            }).catch(() => {
                // Fallback for older browsers
                copyToClipboardFallback(allCards);
                updateStatus(`‚úÖ All ${generatedCards.length} cards copied to clipboard!`, '#27ae60');
            });
        }

        function copyToClipboardFallback(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
        }

        function clearResults() {
            generatedCards = [];
            selectedCardIndex = null;
            document.getElementById('cardsDisplay').innerHTML = 
                '<div style="text-align: center; color: #7f8c8d; padding: 20px;">No cards generated yet. Click the generate button to start.</div>';
            document.getElementById('progressFill').style.width = '0%';
            updateStatus('Ready to generate', '#27ae60');
        }

        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
        }

        function updateStatus(message, color) {
            const statusLabel = document.getElementById('statusLabel');
            statusLabel.textContent = message;
            statusLabel.style.color = color;
        }
    </script>
</body>
</html>
